{"ast":null,"code":"let nextBuyId = 0;\nexport const BUY_PRODUCT = 'BUY_PRODUCT';\nexport const NOBUY_PRODUCT = 'NOBUY_PRODUCT';\nexport const CHANGENUM_PRODUCT = 'CHANGENUM_PRODUCT';\nexport const REQUEST_POSTS = 'REQUEST_POSTS';\nexport const RECEIVE_POSTS = 'RECEIVE_POSTS';\nexport const INVALIDATE_SUBREDDIT = 'INVALIDATE_SUBREDDIT';\nexport function buyproduct(product, quantity) {\n  return {\n    type: BUY_PRODUCT,\n    id: nextBuyId++,\n    product,\n    quantity\n  };\n}\nexport function nobuyproduct(id) {\n  return {\n    type: NOBUY_PRODUCT,\n    id\n  };\n}\nexport function changenumproduct(id, quantity) {\n  return {\n    type: CHANGENUM_PRODUCT,\n    id,\n    quantity\n  };\n}\n\nfunction requestPosts() {\n  return {\n    type: REQUEST_POSTS\n  };\n}\n\nfunction receivePosts(json) {\n  return {\n    type: RECEIVE_POSTS,\n    posts: json\n  };\n}\n\nfunction fetchPosts(product) {\n  return dispatch => {\n    dispatch(requestPosts(product));\n    return fetch(\"https://test-9af27.firebaseio.com/users/Hank/product.json\").then(response => response.json()).then(json => dispatch(receivePosts(json)));\n  };\n}\n\nfunction shouldFetchPosts(state) {\n  const posts = state.postByProduct;\n\n  if (posts.commodity.length === 0) {\n    return true;\n  } else if (posts.isFetching) {\n    return false;\n  } else {\n    return posts.didInvalidate;\n  }\n}\n\nexport function fetchPostsIfNeeded() {\n  return (dispatch, getState) => {\n    if (shouldFetchPosts(getState())) {\n      return dispatch(fetchPosts());\n    }\n  };\n}","map":{"version":3,"sources":["/Users/phoebe/homework/obdesign/src/action/index.js"],"names":["nextBuyId","BUY_PRODUCT","NOBUY_PRODUCT","CHANGENUM_PRODUCT","REQUEST_POSTS","RECEIVE_POSTS","INVALIDATE_SUBREDDIT","buyproduct","product","quantity","type","id","nobuyproduct","changenumproduct","requestPosts","receivePosts","json","posts","fetchPosts","dispatch","fetch","then","response","shouldFetchPosts","state","postByProduct","commodity","length","isFetching","didInvalidate","fetchPostsIfNeeded","getState"],"mappings":"AAAA,IAAIA,SAAS,GAAG,CAAhB;AACA,OAAO,MAAMC,WAAW,GAAG,aAApB;AACP,OAAO,MAAMC,aAAa,GAAG,eAAtB;AACP,OAAO,MAAMC,iBAAiB,GAAG,mBAA1B;AACP,OAAO,MAAMC,aAAa,GAAG,eAAtB;AACP,OAAO,MAAMC,aAAa,GAAG,eAAtB;AACP,OAAO,MAAMC,oBAAoB,GAAG,sBAA7B;AAEP,OAAO,SAASC,UAAT,CAAoBC,OAApB,EAA4BC,QAA5B,EAAqC;AACxC,SAAM;AACFC,IAAAA,IAAI,EAAGT,WADL;AAEFU,IAAAA,EAAE,EAAGX,SAAS,EAFZ;AAGFQ,IAAAA,OAHE;AAIFC,IAAAA;AAJE,GAAN;AAMH;AACD,OAAO,SAASG,YAAT,CAAsBD,EAAtB,EAAyB;AAC5B,SAAM;AACFD,IAAAA,IAAI,EAAGR,aADL;AAEFS,IAAAA;AAFE,GAAN;AAIH;AACD,OAAO,SAASE,gBAAT,CAA0BF,EAA1B,EAA6BF,QAA7B,EAAsC;AACzC,SAAM;AACFC,IAAAA,IAAI,EAAGP,iBADL;AAEFQ,IAAAA,EAFE;AAGFF,IAAAA;AAHE,GAAN;AAKH;;AAED,SAASK,YAAT,GAAwB;AACpB,SAAO;AACHJ,IAAAA,IAAI,EAAEN;AADH,GAAP;AAGH;;AAED,SAASW,YAAT,CAAsBC,IAAtB,EAA4B;AACxB,SAAO;AACHN,IAAAA,IAAI,EAAEL,aADH;AAEHY,IAAAA,KAAK,EAAED;AAFJ,GAAP;AAIH;;AAED,SAASE,UAAT,CAAoBV,OAApB,EAA6B;AACzB,SAAOW,QAAQ,IAAI;AACfA,IAAAA,QAAQ,CAACL,YAAY,CAACN,OAAD,CAAb,CAAR;AACA,WAAOY,KAAK,6DAAL,CACNC,IADM,CACDC,QAAQ,IAAIA,QAAQ,CAACN,IAAT,EADX,EAENK,IAFM,CAEDL,IAAI,IAAIG,QAAQ,CAACJ,YAAY,CAACC,IAAD,CAAb,CAFf,CAAP;AAGH,GALD;AAMH;;AAED,SAASO,gBAAT,CAA0BC,KAA1B,EAAmC;AAC/B,QAAMP,KAAK,GAAGO,KAAK,CAACC,aAApB;;AACA,MAAIR,KAAK,CAACS,SAAN,CAAgBC,MAAhB,KAAyB,CAA7B,EAAgC;AAC5B,WAAO,IAAP;AACH,GAFD,MAEO,IAAIV,KAAK,CAACW,UAAV,EAAsB;AACzB,WAAO,KAAP;AACH,GAFM,MAEA;AACH,WAAOX,KAAK,CAACY,aAAb;AACH;AACJ;;AAED,OAAO,SAASC,kBAAT,GAA8B;AACjC,SAAO,CAACX,QAAD,EAAWY,QAAX,KAAwB;AAC3B,QAAIR,gBAAgB,CAACQ,QAAQ,EAAT,CAApB,EAAkC;AAC9B,aAAOZ,QAAQ,CAACD,UAAU,EAAX,CAAf;AACH;AAAK,GAHV;AAIH","sourcesContent":["let nextBuyId = 0;\nexport const BUY_PRODUCT = 'BUY_PRODUCT'\nexport const NOBUY_PRODUCT = 'NOBUY_PRODUCT'\nexport const CHANGENUM_PRODUCT = 'CHANGENUM_PRODUCT'\nexport const REQUEST_POSTS = 'REQUEST_POSTS'\nexport const RECEIVE_POSTS = 'RECEIVE_POSTS'\nexport const INVALIDATE_SUBREDDIT = 'INVALIDATE_SUBREDDIT'\n\nexport function buyproduct(product,quantity){\n    return{\n        type : BUY_PRODUCT ,\n        id : nextBuyId++,\n        product,\n        quantity\n    };\n}\nexport function nobuyproduct(id){\n    return{\n        type : NOBUY_PRODUCT ,\n        id\n    };\n}\nexport function changenumproduct(id,quantity){\n    return{\n        type : CHANGENUM_PRODUCT ,\n        id,\n        quantity\n    };\n}\n\nfunction requestPosts() {\n    return {\n        type: REQUEST_POSTS,\n    }\n}\n\nfunction receivePosts(json) {\n    return {\n        type: RECEIVE_POSTS,\n        posts: json\n    }\n}\n\nfunction fetchPosts(product) {\n    return dispatch => {\n        dispatch(requestPosts(product))\n        return fetch(`https://test-9af27.firebaseio.com/users/Hank/product.json`)\n        .then(response => response.json())\n        .then(json => dispatch(receivePosts(json)))\n    }\n}\n\nfunction shouldFetchPosts(state, ) {\n    const posts = state.postByProduct\n    if (posts.commodity.length===0) {\n        return true\n    } else if (posts.isFetching) {\n        return false\n    } else {\n        return posts.didInvalidate\n    }\n}\n\nexport function fetchPostsIfNeeded() {\n    return (dispatch, getState) => {\n        if (shouldFetchPosts(getState())) {\n            return dispatch(fetchPosts())\n        }    }\n}"]},"metadata":{},"sourceType":"module"}